<!DOCTYPE html>
<html>
	<!--'Calendrical Coversions' by Joshua, 25/6/2021-->
	<!--Version 2.0.0, 22/7/2022-->
	<!--How much more boring can I get?-->
	
	<!-- Bibilography:
		Principle sources:
			Reingold, E. & Dershowitz, N. (2018). 'Calendrical Calculations: The Ultimate Edition'. Cambridge University Press. DOI: https://doi.org/10.1017/9781107415058
			Basically, all of Wikipedia.
		Other sources (not an exhaustive list \_(-_-)_/):
			Karjanto, N. & Beauducel, F. (2020). 'An ethnoarithmetic excursion into the Javanese calendar'. URL: https://arxiv.org/pdf/2012.10064.pdf
			Haberl, C. (2021). 'Of Calendars—and Kings—and Why the Winter is Boiling Hot'. Journal of the Royal Asiatic Society, 31, 3. DOI: https://doi.org/10.1017/S1356186320000759
			Janson, S. (2011). 'The Icelandic Calendar', Scripta Islandica, 62. URL: https://uu.diva-portal.org/smash/get/diva2:436604/FULLTEXT01.pdf
			Van Gent, R.. URL: https://webspace.science.uu.nl/~gent0113/islam/islam_tabcal.htm
	-->
	<!-- By the way, I named in 'Calendrical' before I discovered the book, so... -->
	<head>
		<title>Calendrical Conversions</title>
		<link rel="icon" type="image/x-icon" href="images/logo.png">
		<link rel="stylesheet" href="fonts/fonts.css">
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap" rel="stylesheet">
		<style>
			* {
				text-size-adjust: none;
			}
			body {
				margin: 0;
				text-align: center;
				font-family: Arial, Gill Sans MT, Arial, sans-serif;
			}
			h1 {
				font-size: 48px;
				text-align: center;
				font-family: Old English Text MT, 'UnifrakturMaguntia', OldEnglish, Arial, sans-serif;
				margin-bottom: 0;
				padding: 0 80px;
			}
			#subtitle {
				font-family: Old English Text MT, OldEnglish, Arial, sans-serif;
				font-size: 24px;
			}
			#header, #body {
				text-align: center;
				font-size: 24px;
			}
			#footer {
				font-size: 16px;
				margin: 0px 20px;
				font-family: Gill Sans MT, Arial, sans-serif;
			}
			select {
				cursor: pointer;
				/*text-align: center;*/
			}
			input, select {
				font-size: inherit;
				background-color: #ffffff;
			}
			select:focus, input:focus {
				outline: none;
			}
			.input {
				border: 2px solid #999999;
				border-radius: 10px;
			}
			.input:focus, .calSelect:focus {
				border-color: #000000;
			}
			input.input {
				padding: 10px 15px;
			}
			select.input {
				padding: 9.5px 15px;
			}
			.calSelect {
				border: none;
				border-bottom: 2px solid #999999;
				padding: 2px 5px;
				/*width: 210px;*/
				max-width: 70%;
				text-align: center;
			}
			.day {
				width: 80px;
			}
			.month {
				max-width: 200px;
			}
			.year {
				width: 120px;
			}
			.number {
				width: 300px;
			}
			.number2 {
				width: 90px;
			}
			hr {
				border: 2px solid #000000;
				background-color: #000000;
			}
			.resultBox {
				background-color: #eeeeee;
				padding: 20px 30px;
				border-radius: 20px;
				display: inline-block;
			}
			.inputPanel {
				line-height: 2.5;
			}
			.btn {
				background-color: #cccccc;
				border-radius: 10px;
				padding: 10px 20px;
				cursor: pointer;
				border: 2px solid #ffffff;
				display: inline-block;
				transition: background-color 0.2s;
			}
			.btn:hover {
				background-color: #999999;
			}
			.btn:active {
				background-color: #bbbbbb;
			}
			.container {
				margin: 0px 2%;
			}
			.wrapper {
				display: grid;
				grid-template-columns: 1fr 50px 1fr;
				margin: 0px 20px;
			}
			.justify {
				display: flex;
				align-items: center;
				justify-content: center;
			}
			.small {
				font-size: 16px;
			}
			#home {
				position: absolute;
				left: 15px;
				top: 15px;
			}
			#homeLogo {
				height: 50px;
			}
			.smallCaps {
				font-variant: small-caps;
			}
		</style>
	</head>
	<body onLoad="setup()" onkeydown="key(event)">
		<script>
			//Maths
			var mod = function (num, p) {
				var n = num;
				if (n < 0) {
					n = p - (-1 * n) % p;
				}
				return n % p;
			}
			var floor = Math.floor;
			//Initiallising
			var cal = [];
			var Cal = function (name, to, from, out, check, input, today = true) {
				this.name = name;
				this.fromJD = to;
				this.toJD = from;
				this.display = out;
				this.valid = check;
				this.input = input;
				this.today = today;
			}
			//Data
			//Gregorian/Julian
			var week = ["Mon", "Tues", "Wednes", "Thurs", "Fri", "Satur", "Sun"];
			var months = [0, "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
			var monthsAbbr = [0, "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
			var week2 = [0];
			for (var i = 1; i <= 7; i++) {
				week2[i] = week[i - 1] + "day";
			}
			var weekSun = [0, "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
			var monthLengths = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
			var isGregorianLeap = function (Y) {
				return mod(Y, 400) === 0 || (mod(Y, 4) === 0 && mod(Y, 100) != 0);
			}
			var dominicalLetter = function (Y) { // A = 0
				var a = floor(Y / 4);
				var b = floor(a / 25);
				var c = floor(b / 4);
				return mod(6 * (Y + a - b + c), 7);
			}
			//Coptic
			var copticMonths = [0, "Thout", "Paopi", "Hathor", "Koiak", "Tobi", "Meshir", "Paremhat", "Parmouti", "Pashons", "Paoni", "Epip", "Mesori", "Pi Kogi Enavot"];
			//French
			var frenchWeek = ["D&#233;ca", "Primi", "Duo", "Tri", "Quarti", "Quinti", "Sexti", "Septi", "Octi", "Noni"];
			var frenchMonths = [0, "Vend&#233;miaire", "Brumaire", "Frimaire", "Niv&#244;se", "Pluvi&#244;se", "Vent&#244;se", "Germinal", "Flor&#233;al", "Prairial", "Messidor", "Thermidor", "Fructidor", "Complementary day"];
			var compDays = [0, "de la Vertu", "du G&#233;nie", "du Travail", "de l'Opinion", "des R&#233;compenses", "de la R&#233;volution"];
			//Roman numerals
			var Roman = function (n) {  
				var result = "";
				var decimal = [1000, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1];
				var rom = ["M", "CM","D","CD","C", "XC", "L", "XL", "X","IX","V","IV","I"];
				if (n < 4000 && n > 0) {
					for (var i = 0; i <= decimal.length; i++) {
						while (n % decimal[i] < n) {      
							result += rom[i];
							n -= decimal[i];
						}
					}
				} else {
					result = n;
				}
				return result;
			}
			//Indian
			var IndianMonths = [0, "Chaitra", "Vais&#257;kha", "Jy&#275;shtha", "&#256;sh&#257;dha", "Shr&#257;vana", "Bh&#257;dra", "&#256;shwin", "K&#257;rtika", "Agrah&#257;yana", "Pausha", "M&#257;gha", "Ph&#257;lguna"];
			//Week
			var weekYearLength = function (x) {
				var p = function (y) {
					var a = floor(y / 4);
					var b = floor(a / 25);
					var c = floor(b / 4);
					return mod(y + a - b + c, 7);
				}
				var result = 52;
				if (p(x) === 4 || p(x - 1) === 3) {
					result++;
				}
				return result;
			}
			//Gregorian Lunar
			var GregEpact = function (Y) {
				var a = mod(Y, 19);
				var b = Math.floor(Y / 100);
				var c = Math.floor(b / 4);
				var d = Math.floor((b + 7) / 25);
				var e = mod(b + 7, 25);
				var f = Math.floor(e / 3);
				var g = Math.floor(e / 24);
				return mod(11 * a + 29 * b + c + 8 * d + f - g + 6, 30);
			}
			var GLunarNewYear = function (Y) {
				var E1 = GregEpact(Y);
				var NY = cal[0].toJD([9, 12, Y - 1]) + mod(23 - E1, 30);
				if (E1 === 24 || (E1 === 25 && mod(Y, 19) > 10)) {
					NY -= 30;
				}
				if (mod(Y, 100) === 0 && mod(Y, 400) != 0) {
					NY--;
				}
				var x = mod(Y, 2500);
				if (x === 200 || x === 500 || x === 800 || x === 1100 || x === 1400 || x === 1800 || x === 2100 || x === 2400) {
					NY++;
				}
				if (mod(Y, 19) === 0) {
					NY++;
				}
				return NY;
			}
			var GLunarMonthLengths = function (x, yL) {
				var result = 30;
				if (x % 2 === 0) {
					result--;
				}
				if (x === 1 && yL % 10 === 3) {
					result--;
				} else if (x === 2 && yL % 10 === 5) {
					result++;
				}
				return result;
			}
			//Islamic
			var IslamicYearLength = function (y, x) {
				var result = 354;
				if (y === 2 || y === 5 || (y === 7 && x === 2) || (y === 8 && x === 3) || y === 10 || y === 13 || y === 16 || (y === 18 && x === 2) || (y === 19 && x === 3) || y === 21 || y === 24 || (y === 26 && x === 2) || (y === 27 && x === 3) || y === 29) {
					result++;
				}
				return result;
			}
			var IslamicMonthLengths = function (m, y, x) {
				var result = 29;
				if (m % 2 === 1 || (m === 12 && IslamicYearLength(y, x) === 355)) {
					result++;
				}
				return result;
			}
			//var IslamicMonths = [0, "Mu&#7717;arram", "&#7778;afar", "Rab&#299;&#8216; al-Awwal", "Rab&#299;&#8216; ath-Th&#257;n&#299;", "Jum&#257;d&#225; al-&#362;l&#225;", "Jum&#257;d&#225; al-&#256;khirah", "Rajab", "Sha&#8216;b&#257;n", "Rama&#7693;&#257;n", "Shaww&#257;l", "Dh&#363; al-Qa&#8216;dah", "Dh&#363; al-&#7716;ijjah"];
			var IslamicMonths = [0, "Mu&#7717;arram", "&#7778;afar", "Rab&#299;&#8216; al-Awwal", "Rab&#299;&#8216; al-Th&#257;n&#299;", "Jum&#257;d&#225; al-Awwal", "Jum&#257;d&#225; al-Th&#257;n&#299;", "Rajab", "Sha&#8216;b&#257;n", "Rama&#7693;&#257;n", "Shaww&#257;l", "Dh&#363; al-Qa&#8216;dah", "Dh&#363; al-&#7716;ijjah"];
			var IslamicDays = ["al-Ithnayn", "ath-Thul&#257;th&#257;"];
			//Julian Lunar
			var JulianEmbols = [0, 12, 0, 0, 9, 0, 0, 3, 0, 12, 0, 0, 11, 0, 0, 8, 0, 0, 3];
			var JLunarMonthsList = function (baseYear) {
				var result = [];
				var ye = baseYear + 1;
				var mo = 1;
				var mL;
				for (var i = 0; i < 235; i++) {
					var mL = 30;
					if ((mo % 2 === 0 && !(mo === 2 && mod(ye, 4) === 0)) || (mo === 7 && mod(ye, 19) === 18)) {
						mL--;
					}
					result[i] = {y: ye, m: mo, mL: mL};
					if (mo === JulianEmbols[mod(ye, 19)]) {
						i++;
						result[i] = {y: ye, m: 13, mL: 30};
					}
					mo++;
					if (mo > 12) {
						mo = 1;
						ye++;
					}
				}
				return result;
			}
			var JLunarMonths = [0, "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December", "Embolism"];
			//Ethiopian
			var EthiopianMonths = [0, "M&#228;sk&#228;r&#228;m", "&#7788;&#601;q&#601;mt", "&#7722;&#601;dar", "Ta&#7723;&#347;a&#347;", "T&#601;rr", "Y&#228;katit", "M&#228;gabit", "Miyazya", "G&#601;nbo", "S&#228;ne", "&#7722;amle", "N&#228;hase", "&#7766;agume"];
			//Hebrew
			var isHebrewLeap = function (Y) {
				var nt = mod(Y, 19);
				var result = false;
				if (nt === 3 || nt === 6 || nt === 8 || nt === 11 || nt === 14 || nt === 17 || nt === 0) {
					var result = true;
				}
				return result;
			}
			var partsPerLun = 765433;
			var partsPerDay = 25920;
			var partsPerWeek = 7 * partsPerDay;
			var meanDaysPerYear = partsPerLun / partsPerDay * 235 / 19;
			var HebrewEpoch = 2450723 * partsPerDay + 23889; // molad Tishrei of 5758 AM.
			var HebrewNewYear = function (Y) {
				var y = Y - 5758;
				var a = floor(y / 19);
				var b = mod(y, 19) + 1;
				var L = a * 235;
				for (var i = 1; i < b; i++) {
					L += 12;
					if (isHebrewLeap(i)) {
						L++;
					}
				}
				var P = L * partsPerLun;
				var molad = HebrewEpoch + P;
				var moladDay = floor(molad / partsPerDay);
				var moladParts = mod(molad, partsPerDay);
				var moladWeekDay = mod(moladDay, 7); // 0 = Monday.
				var resultDay = moladDay;
				if (moladParts >= partsPerDay / 2 || (isHebrewLeap(Y - 1) && moladWeekDay === 0 && moladParts >= 10309)) {
					resultDay++;
				} else if (!isHebrewLeap(Y) && moladWeekDay === 1 && moladParts >= 3444) {
					resultDay += 2;
				}
				var resultWeekDay = mod(resultDay, 7);
				if (resultWeekDay === 6 || resultWeekDay === 2 || resultWeekDay === 4) {
					resultDay++;
				}
				return resultDay;
			}
			var HebrewMonths = [0, "Nisan", "Iyar", "Sivan", "Tammuz", "Av", "Elul", "Tishrei", "Cheshvan", "Kislev", "Tevet", "Shevat", "Adar I", "Adar (II)"];
			var HebrewMonthLength = function (m, len) { // Tishrei = 0, Adar I = 5
				var result = 30;
				if (m === 3 || m === 6 || m === 8 || m === 10 || m === 12 || (m === 1 && len % 10 != 5) || (m === 2 && len % 10 === 3)) {
					result--;
				}
				if (m === 5 && len < 380) {
					result = 0;
				}
				return result;
			}
			//Byzantine
			var ByzantineMonths = [0, "September", "October", "November", "December", "January", "February", "March", "April", "May", "June", "July", "August"];
			//Ordinal
			var Ordinal = function (x) {
				var y = x.toString();
				var result = "th";
				if (mod(x, 100) === 11 || mod(x, 100) === 12 || mod(x, 100) === 13) {
					// Pass
				} else if (mod(x, 10) === 1) {
					result = "st"
				} else if (mod(x, 10) === 2) {
					result = "nd"
				} else if (mod(x, 10) === 3) {
					result = "rd"
				}
				return y + "<sup>" + result + "</sup>";
			}
			//Armenian
			var ArmenianJDepoch = 1922868; // Armenian date 1/1/1
			var ArmenianWeek = ["Erkoushabathi", "Erekhshabathi", "Chorekhshabathi", "Hingshabathi", "Urbath", "Shabath", "Kiraki"];
			var ArmenianMonths = [0, "Nawasardi", "Hor&#772;i", "Sahmi", "Tre&#772;", "K&#8216;aloch", "Arach", "Mehekani", "Areg", "Ahekani", "Mareri", "Margach", "Hrotich", "Aweleach"];
			//Nanakshahi
			var SikhYearZero = 1468;
			var SikhMonthLengths = function (M) {
				var result = 30;
				if (M <= 5 || M === 12) {
					result++;
				}
				return result;
			}
			var SikhMonths = [0, "Chet", "Vaisakh", "Jeth", "Harh", "Sawan", "Bhadon", "Assu", "Kattak", "Maghar", "Poh", "Magh", "Phaggan"];
			//Roman-form
			var RomanEvents = [0, "Kalends", "Nones", "Ides"];
			var RomanEventsAbbr = [0, "Kal", "Non", "Id"];
			var toRomanForm = function (A, isLeap) {
				var D = A[0];
				var M = A[1];
				var Y = A[2];
				var bis = 1;
				var RC;
				var RP;
				var RM = M;
				var RY = Y;
				var ides = 13;
				if (M === 3 || M === 5 || M === 7 || M === 10) {
					ides = 15;
				}
				var nones = ides - 8;
				if (isLeap && M === 2) {
					if (D === 24) {
						bis = 2;
					} else if (D > 24) {
						D--;
					}
				}
				if (D === 1) {
					RP = 1;
					RC = 1;
				} else if (D <= nones) {
					RP = 2;
					RC = nones - D + 1;
				} else if (D <= ides) {
					RP = 3;
					RC = ides - D + 1;
				} else {
					if (M === 12) {
						RM = 1;
						RY++;
					} else {
						RM++;
					}
					RP = 1;
					RC = monthLengths[M] - D + 2;
				}
				return [bis, RC, RP, RM, RY];
			}
			var fromRomanForm = function (A, isLeap) {
				var bis = A[0];
				var RC = A[1];
				var RP = A[2];
				var RM = A[3];
				var RY = A[4];
				var D;
				var M = RM;
				var Y = RY;
				var ides = 13;
				if (M === 3 || M === 5 || M === 7 || M === 10) {
					ides = 15;
				}
				var nones = ides - 8;
				if (RP === 1 && RC === 1) {
					D = 1;
				} else if (RP === 2) {
					D = nones - RC + 1;
				} else if (RP === 3) {
					D = ides - RC + 1;
				} else {
					if (RM === 1) {
						M = 12;
						Y--;
					} else {
						M--;
					}
					D = monthLengths[M] - RC + 2;
				}
				if (isLeap && M === 2 && bis === 1 && D >= 24) {
					D++;
				}
				return [D, M, Y];
			}
			var isValidRomanForm = function (A, isLeap) {
				var bis = A[0];
				var RC = A[1];
				var RP = A[2];
				var RM = A[3];
				var RY = A[4];
				var M = RM;
				var result = false;
				if (RC >= 1 && RM >= 1 && RM <= 12) {
					if (bis === 2) {
						if (isLeap && RM === 3 && RP === 1 && RC === 6) {
							result = true;
						}
					} else if (bis === 1) {
						if (RP === 1 && RC === 1) {
							result = true;
						} else {
							if (RP === 1) {
								M = mod(RM - 2, 12) + 1;
							}
							var ides = 13;
							if (M === 3 || M === 5 || M === 7 || M === 10) {
								ides = 15;
							}
							var nones = ides - 8;
							if ((RP === 2 && RC <= nones - 1) || (RP === 3 && RC <= 8) || (RP === 1 && RC <= monthLengths[M] - ides + 1)) {
								result = true;
							}
						}
					}
				}
				return result;
			}
			//Icelandic
			//(https://uu.diva-portal.org/smash/get/diva2:436604/FULLTEXT01.pdf)
			var IcelandicNewYear = function (Y) {
				var DL = dominicalLetter(Y);
				var D = 19 + mod(DL + 1, 7);
				return [D, 4, Y];
			}
			var IcelandicSeasons = [0, "Summer", "Winter"];
			var IcelandicMonths = [0, "Harpa", "Skerpla", "S&#243;lm&#225;nu&#240;ur", "Heyannir", "Tv&#237;m&#225;nu&#240;ur", "Haustm&#225;nu&#240;ur", "Gorm&#225;nu&#240;ur", "&#221;lir", "M&#246;rsugur", "&#222;orri", "G&#243;a", "Einm&#225;nu&#240;ur", "aukan&#230;tur", "sumarauki"];
			//Bangladeshi 
			//(https://en.wikipedia.org/wiki/Bengali_calendars https://bn.wikipedia.org/wiki/%E0%A6%AC%E0%A6%99%E0%A7%8D%E0%A6%97%E0%A6%BE%E0%A6%AC%E0%A7%8D%E0%A6%A6 )
			var BengaliMonths = [0, "Boishakh", "Joishtho", "Asharh", "Srabon", "Bhadro", "Ashvin", "Kartika", "Ogrohayon", "Poush", "Magh", "Falgun", "Choitro"];
			var BengaliYearZero = 593;
			var BangladeshiMonthLengths = function (M, isLeap, isNew) {
				var result = 30;
				if (M <= 5 || (isNew && M === 6)) {
					result++;
				} else if (isNew && M === 11) {
					result--;
				}
				if (isLeap && M === 11) {
					result++;
				}
				return result;
			}
			//Bahai
			var BahaiMonths = [0, "Bah&#225;", "Jal&#225;l", "Jam&#225;l", "&#8216;A&#7827;amat", "N&#250;", "Ra&#7717;mat", "Kalim&#225;t", "Kam&#225;l", "Asm&#225;&#8217;", "&#8216;Izzat", "Mash&#237;yyat", "&#8216;Ilm", "Qudrat", "Qawl", "Mas&#225;&#8217;il", "Sharaf", "Sul&#7789;&#225;n", "Mulk", "Ayy&#225;m-i-H&#225;", "&#8216;Al&#225;&#8217;"];
			var BahaiYearZero = 1843;
			//Mandaean
			var MandaeanMonths = [0, "&#352;ab&#257;&#7789;", "&#256;d&#257;r", "Nis&#257;n", "Ay&#257;r", "Siw&#257;n", "Tammuz", "&#256;b", "Aylul", "Parw&#257;n&#257;y&#257;", "Te&#353;rin", "Ma&#353;r&#601;w&#257;n", "K&#257;nun", "&#7788;&#257;bit"];
			var MandaeanEpochJD = -173231148;
			//Javanese
			// (https://arxiv.org/pdf/2012.10064.pdf)
			var JavaneseKurupStartJD = 2428252;
			var JavaneseKurupStartYear = 1867; // AJ
			var JavaneseFiveDays = ["Pon", "Wage", "Kliwon", "L&#234;gi", "Pahing"];
			var JavaneseSevenDays = ["Ngahad", "S&#234;n&#232;n", "Selasa", "R&#234;bo", "K&#234;mis", "Jemuwah", "S&#234;tu"];
			var JavaneseMonths = [0, "Sura", "Sapar", "Mulud", "Bakdamulud", "Jumadilawal", "Jumadilakir", "Rejeb", "Ruwah", "Pasa", "Sawal", "Dulkangidah", "Besar"];
			var JavaneseYears = [0, "Alip", "Eh&#233;", "Jimawal", "J&#233;", "Dal", "B&#233;", "Wawu", "Jimakir"];
			var JavaneseMonthLengths = function (M) {
				var result = 30;
				if (M % 2 === 0 && M != 12) {
					result--;
				}
				return result;
			}
			var JavaneseYearLengths = function (Y) {
				var result = 354;
				if (Y === 2 || Y === 4 || Y === 8) {
					result++;
				}
				return result;
			}
			var JavaneseWinduLength = 2835; // days
			var JavaneseKurupLength = JavaneseWinduLength * 15 - 1; // days
			//Persian
			// (http://www.astro.uni.torun.pl/~kb/Papers/EMP/PersianC-EMP.htm https://en.wikipedia.org/wiki/Solar_Hijri_calendar)
			var PersianMonths = [0, "Farvardin", "Ordibehesht", "Khordad", "Tir", "Mordad", "Shahrivar", "Mehr", "Aban", "Azar", "Dey", "Bahman", "Esfand"];
			var PersianLeapYears = [1, 5, 9, 13, 13, 17, 22, 26, 30];
			var PersianYearLengths = function (Y) {
				var result = 365;
				if (PersianLeapYears.includes(Y)) {
					result++;
				}
				return result;
			}
			var PersianRefJD = 2454181; // Persian 1/1/1386
			var PersianRefYear = 1386;
			var PersianDaysPerCycle = 365 * 33 + 8;
			var PersianMonthLengths = function (M) {
				var result = 30;
				if (M <= 6) {
					result++;
				}
				return result;
			}
			// Shorthand
			var date = function (x) {
				return x[0] + "/" + x[1] + "/" + x[2];
			}
			var longDate = function (x, M) {
				return x[0] + " " + M[x[1]] + " " + x[2];
			}
			var abbr = function (string, name, smallCaps = true) {
				var cl = "";
				var string2 = string;
				if (smallCaps) {
					cl = 'class="smallCaps" ';
					string2 = string.toLowerCase();
				}
				return '<span ' + cl + 'title="' + name + '">' + string2 + '</span>';
			}
			var show = function (a, id) {
				var result = "";
				for (var i = 0; i < a.length; i++) {
					if (i != 0) {
						result += "<br>"
					}
					result += a[i];
				}
				return result;
			}
			var dayInput = function (x, max, min = 1, name = "day") {
				return '<input class="dateIn' + x + ' day input" type="number" min="' + min + '" max="' + max + '" step="1" placeholder="' + name + '">';
			}
			var monthInput = function (x, array, name = "month") {
				var result = '<select class="dateIn' + x + ' month input"><option value="" hidden selected>' + name + '</option>';
				for (var i = 1; i < array.length; i++) {
					result += '<option value="' + i + '">' + array[i] + '</option>';
				}
				result += '</select>';
				return result;
			}
			var yearInput = function (x) {
				return '<input class="dateIn' + x + ' year input" type="number" step="1" placeholder="year">';
			}
			var DMYInput = function (x, array, max) {
				return dayInput(x, max) + " " + monthInput(x, array) + " " + yearInput(x);
			}
			var numberInput = function (x, name = "") {
				return '<input class="dateIn' + x + ' number input" type="number" step="1" placeholder="' + name + '">';
			}
			var number2Input = function (x, name = "") {
				return '<input class="dateIn' + x + ' number2 input" type="number" step="1" placeholder="' + name + '">';
			}
			var valueInput = function (x, min, max, name = "") {
				return '<input class="dateIn' + x + ' number2 input" type="number" step="1" placeholder="' + name + '" min="' + min + '" max="' + max + '">';
			}
			//Calendars
			cal[0] = new Cal(
				"Gregorian",
				function (JD) {
					var diff = 1721060;
					var T = mod(JD - diff, 400 * 365 + 97);
					var yearLength = function (x) {
						var result = 365;
						if (x % 400 === 0 || (x % 4 === 0 && x % 100 != 0)) {
							result++;
						}
						return result;
					}
					var mL = function (x, y) {
						var result = monthLengths[x];
						if (yearLength(y) === 366 && x === 2) {
							result = 29;
						}
						return result;
					}
					var j = 0;
					while (T - yearLength(j) >= 0) {
						T -= yearLength(j);
						j++;
					}
					var Y = floor((JD - diff) / (400 * 365 + 97)) * 400 + j;
					var k = 1;
					while (T - mL(k, j) >= 0) {
						T -= mL(k, j);
						k++;
					}
					return [T + 1, k, Y];
				},
				function (G) {
					D = G[0];
					M = G[1];
					Y = G[2];
					if (M <= 2) {
						Y--;
						M += 12;
					}
					var A = floor(Y / 100);
					var B = floor(A / 4);
					var C = 2 - A + B;
					var E = floor(365.25 * (Y + 4716));
					var F = floor(30.6001 * (M + 1));
					return C + D + E + F - 1524.5 + 0.5;
				},
				function (G, JD) {
					return [week[mod(JD, 7)] + "day,", G[0] + " " + months[G[1]] + " " + G[2] + " " + abbr("A.D.", "anno Domini"), "(" + date(G) + ")"];
				},
				function (G) {
					var result = false;
					if (G[1] >= 1 && G[1] <= 12) {
						if (G[0] >= 1 && G[0] <= monthLengths[G[1]]) {
							result = true;
						} else if (G[0] === 29 && G[1] === 2 && (mod(G[2], 400) === 0 || (mod(G[2], 4) === 0 && mod(G[2], 100) != 0))) {
							result = true;
						}
					}
					return result;
				},
				DMYInput(0, months, 31)
			);
			cal[1] = new Cal(
				"Julian",
				function (JD) {
					var diff = 1721058;
					var T = mod(JD - diff, 4 * 365 + 1);
					var yearLength = function (x) {
						var result = 365;
						if (x % 4 === 0) {
							result++;
						}
						return result;
					}
					var mL = function (x, y) {
						var result = monthLengths[x];
						if (yearLength(y) === 366 && x === 2) {
							result = 29;
						}
						return result;
					}
					var j = 0;
					while (T - yearLength(j) >= 0) {
						T -= yearLength(j);
						j++;
					}
					var Y = floor((JD - diff) / (4 * 365 + 1)) * 4 + j;
					var k = 1;
					while (T - mL(k, j) >= 0) {
						T -= mL(k, j);
						k++;
					}
					return [T + 1, k, Y];
				},
				function (J) {
					var D = J[0];
					var M = J[1];
					var Y = J[2];
					if (M <= 2) {
						Y--;
						M += 12;
					}
					var E = floor(365.25 * (Y + 4716));
					var F = floor(30.6001 * (M + 1));
					return D + E + F - 1524.5 + 0.5;
				},
				cal[0].display,
				function (J) {
					var result = false;
					if (J[1] >= 1 && J[1] <= 12) {
						if (J[0] >= 1 && J[0] <= monthLengths[J[1]]) {
							result = true;
						} else if (J[0] === 29 && J[1] === 2 && mod(J[2], 4) === 0) {
							result = true;
						}
					}
					return result;
				},
				DMYInput(1, months, 31)
			);
			cal[2] = new Cal(
				"Coptic",
				function (JD) {
					var diff = 2454356;
					var T = mod(JD - diff, 4 * 365 + 1);
					var j = 0;
					while (T - 365 >= 0 && j < 3) {
						T -= 365;
						j++;
					}
					var D = T % 30 + 1;
					var M = floor(T / 30) + 1;
					var Y = floor((JD - diff) / (4 * 365 + 1)) * 4 + j + 1724;
					return [D, M, Y];
				},
				function (C) {
					var D = C[0];
					var M = C[1];
					var Y = C[2];
					return floor(365.25 * Y) + 1824664 + (M - 1) * 30 + D;
				},
				function (C, JD) {
					return [week[mod(JD, 7)] + "day,", C[0] + " " + copticMonths[C[1]] + " " + C[2] + " " + abbr("A.M.", "anno martyrum"), "(" + date(C) + ")"];
				},
				function (C) {
					var result = false;
					if (C[1] >= 1 && C[1] <= 12 && C[0] >= 1 && C[0] <= 30) {
						result = true;
					} else if (C[1] === 13) {
						if ((C[0] >= 1 && C[0] <= 5) || (C[0] === 6 && mod(C[2], 4) === 3)) {
							result = true;
						}
					}
					return result;
				},
				DMYInput(2, copticMonths, 30)
			);
			cal[3] = new Cal(
				"French Republican (Romme version)",
				function (JD) {
					var diff = 2375840;
					var T = mod(JD - diff, 4000 * 365 + 969);
					var yearLength = function (x) {
						var result = 365;
						if ((x % 400 === 0 && x % 4000 != 0) || (x % 4 === 0 && x % 100 != 0)) {
							result++;
						}
						return result;
					}
					var j = 1;
					while (T - yearLength(j) >= 0) {
						T -= yearLength(j);
						j++;
					}
					var Y = floor((JD - diff) / (4000 * 365 + 969)) * 4000 + j;
					var M = floor(T / 30) + 1;
					var D = T % 30 + 1;
					return [D, M, Y];
				},
				function (F) {
					var D = F[0];
					var M = F[1] - 1;
					var Y = F[2] - 1;
					var T = Y * 365 + floor(Y / 4) - floor(Y / 100) + floor(Y / 400) - floor(Y / 4000);
					return 2375840 + T + M * 30 + D - 1;
				},
				function (F, JD) {
					var D = F[0];
					var M = F[1];
					var Y = F[2];
					var w = "";
					var d;
					if (M === 13) {
						d = "La F&#234;te " + compDays[D] + " an " + Roman(Y);
					} else {
						w = frenchWeek[D % 10] + "di,";
						d = D + " " + frenchMonths[M] + " an " + Roman(Y);
					}
					return [w, d, "(" + date(F) + ")"];
				},
				function (F) {
					var result = false;
					var D = F[0];
					var M = F[1];
					var Y = F[2];
					if ((M >= 1 && M <= 12 && D >= 1 && D <= 30) || (M === 13 && ((D >= 1 && D <= 5) || (D === 6 && ((mod(Y, 400) === 0 && mod(Y, 4000) != 0) || (mod(Y, 4) === 0 && mod(Y, 100) != 0)))))) {
						result = true;
					}
					return result;
				},
				DMYInput(3, frenchMonths, 30)
			);
			cal[4] = new Cal(
				"French Republican (Romme&#8722;1 version)",
				function (JD) {
					var diff = 2375840;
					var T = mod(JD - diff, 4000 * 365 + 969);
					var yearLength = function (y) {
						var result = 365;
						var x = y + 1;
						if ((x % 400 === 0 && x % 4000 != 0) || (x % 4 === 0 && x % 100 != 0)) {
							result++;
						}
						return result;
					}
					var j = 1;
					while (T - yearLength(j) >= 0) {
						T -= yearLength(j);
						j++;
					}
					var Y = floor((JD - diff) / (4000 * 365 + 969)) * 4000 + j;
					var M = floor(T / 30) + 1;
					var D = T % 30 + 1;
					return [D, M, Y];
				},
				function (F) {
					var D = F[0];
					var M = F[1] - 1;
					var Y = F[2];
					var T = (Y - 1) * 365 + floor(Y / 4) - floor(Y / 100) + floor(Y / 400) - floor(Y / 4000);
					return 2375840 + T + M * 30 + D - 1;
				},
				cal[3].display,
				function (F) {
					var result = false;
					var D = F[0];
					var M = F[1];
					var X = F[2];
					var Y = X + 1;
					if ((M >= 1 && M <= 12 && D >= 1 && D <= 30) || (M === 13 && ((D >= 1 && D <= 5) || (D === 6 && ((mod(Y, 400) === 0 && mod(Y, 4000) != 0) || (mod(Y, 4) === 0 && mod(Y, 100) != 0)))))) {
						result = true;
					}
					return result;
				},
				DMYInput(4, frenchMonths, 30),
				false
			);
			cal[5] = new Cal(
				"Revised Julian",
				function (JD) {
					var diff = 1721426;
					var T = mod(JD - diff, 900 * 365 + 218);
					var yearLength = function (x) {
						var result = 365;
						if (x % 900 === 200 || x % 900 === 600 || (x % 4 === 0 && x % 100 != 0)) {
							result++;
						}
						return result;
					}
					var mL = function (x, y) {
						var result = monthLengths[x];
						if (yearLength(y) === 366 && x === 2) {
							result = 29;
						}
						return result;
					}
					var j = 1;
					while (T - yearLength(j) >= 0) {
						T -= yearLength(j);
						j++;
					}
					var Y = floor((JD - diff) / (900 * 365 + 218)) * 900 + j;
					var k = 1;
					while (T - mL(k, j) >= 0) {
						T -= mL(k, j);
						k++;
					}
					return [T + 1, k, Y];
				},
				function (RJ) {
					D = RJ[0];
					M = RJ[1];
					Y = RJ[2];
					if (M <= 2) {
						Y--;
						M += 12;
					}
					var E = floor(Y / 100);
					var A = 2 * floor((E + 3) / 9);
					var B = floor(mod(E + 3, 9) / 5);
					var C = floor(30.6001 * (M + 1)) - 122;
					var T = Y * 365 + floor(Y / 4) - E + A + B;
					return T + C + D + 1721119;
				},
				cal[1].display,
				function (RJ) {
					D = RJ[0];
					M = RJ[1];
					Y = RJ[2];
					var result = false;
					if ((M >= 1 && M <= 12) && ((D >= 1 && D <= monthLengths[M]) || (D === 29 && M === 2 && (mod(Y, 900) === 200 || mod(Y, 900) === 600 || (mod(Y, 4) === 0 && mod(Y, 100) != 0))))) {
						result = true;
					}
					return result;
				},
				DMYInput(5, months, 31),
				false
			);
			cal[6] = new Cal(
				"Julian Day",
				function (JD) {
					return [JD];
				},
				function (J) {
					return J[0];
				},
				function (J, JD) {
					return [abbr("J.D.", "Julian date") + " " + JD, "at midday"];
				},
				function (J) {
					return true;
				},
				numberInput(6, "Julian date at midday")
			);
			cal[7] = new Cal(
				"Lilian Day",
				function (JD) {
					return [JD - 2299160];
				},
				function (L) {
					return L[0] + 2299160;
				},
				function (L, JD) {
					return ["Lilian day number", L[0]];
				},
				function (L) {
					return true;
				},
				numberInput(7, "Lilian day number")
			);
			cal[8] = new Cal(
				"Gregorian BC",
				function (JD) {
					var G = cal[0].fromJD(JD);
					return [G[0], G[1], 1 - G[2]];
				},
				function (GBC) {
					return cal[0].toJD([GBC[0], GBC[1], 1 - GBC[2]]);
				},
				function (G, JD) {
					return [week[mod(JD, 7)] + "day,", G[0] + " " + months[G[1]] + " " + G[2] + " " + abbr("B.C.", "before Christ"), "(" + date(G) + "BC)"];
				},
				function (GBC) {
					return cal[0].valid([GBC[0], GBC[1], 1 - GBC[2]]);
				},
				DMYInput(8, months, 31) + "BC",
				false
			);
			cal[9] = new Cal(
				"Julian BC",
				function (JD) {
					var J = cal[1].fromJD(JD);
					return [J[0], J[1], 1 - J[2]];
				},
				function (JBC) {
					return cal[1].toJD([JBC[0], JBC[1], 1 - JBC[2]]);
				},
				cal[8].display,
				function (JBC) {
					return cal[1].valid([JBC[0], JBC[1], 1 - JBC[2]]);
				},
				DMYInput(9, months, 31) + "BC",
				false
			);
			cal[10] = new Cal(
				"Unix Time",
				function (JD) {
					return [JD - 2440588];
				},
				function (U) {
					return U[0] + 2440588;
				},
				function (U, JD) {
					var s = "s";
					if (U[0] === 1) {
						s = "";
					}
					return [U[0] + " day" + s, "since the Unix epoch", "(" + (U[0] * 86400) + "s at midnight UTC)"];
				},
				function (U) {
					return true;
				},
				numberInput(10, "Days since Unix epoch")
			);
			cal[11] = new Cal(
				"Indian National",
				function (JD) {
					var diff = 1749630;
					var T = mod(JD - diff, 400 * 365 + 97);
					var yL = function (y) {
						var result = 365;
						var x = y + 78;
						if (x % 400 === 0 || (x % 4 === 0 && x % 100 != 0)) {
							result++;
						}
						return result;
					}
					var mL = function (m, y) {
						var result = 30;
						if ((m >= 2 && m <= 6) || (m === 1 && yL(y) === 366)) {
							result = 31;
						}
						return result;
					}
					var j = 0;
					while (T - yL(j) >= 0) {
						T -= yL(j);
						j++;
					}
					var Y = floor((JD - diff) / (400 * 365 + 97)) * 400 + j;
					var k = 1;
					while (T - mL(k, j) >= 0) {
						T -= mL(k, j);
						k++;
					}
					return [T + 1, k, Y];
				},
				function (I) {
					D = I[0];
					M = I[1];
					Y = I[2] + 78;
					if (M === 1) {
						Y--;
						M += 12;
					}
					var A = floor(Y / 4) - floor(78 / 4);
					var B = floor(Y / 100);
					var C = floor(B / 4);
					var E = (Y - 78) * 365;
					var F = 0;
					for (var i = 2; i < M; i++) {
						F += 30;
						if (i <= 6) {
							F++;
						}
					}
					return A - B + C + E + F + D + 1749659;
				},
				function (I, JD) {
					var IndianWeek = ["Soma", "Mangala", "Budha", "Guru", "Shukra", "Shani", "Ravi"];
					return [IndianWeek[mod(JD, 7)] + "v&#257;r,", I[0] + " " + IndianMonths[I[1]] + " " + I[2] + " " + abbr("S.E.", "Saka era"), "(" + date(I) + ")"];
				},
				function (I) {
					var result = false;
					var D = I[0];
					var M = I[1];
					var Y = I[2] + 78;
					if ((M >= 2 && M <= 6 && D >= 1 && D <= 31) || ((M === 1 || (M >= 7 && M <= 12)) && D >= 1 && D <= 30) || (M === 1 && D === 31 && (mod(Y, 400) === 0 || (mod(Y, 4) === 0 && mod(Y, 100) != 0)))) {
						result = true;
					}
					return result;
				},
				DMYInput(11, IndianMonths, 31)
			);
			cal[12] = new Cal(
				"ISO Week",
				function (JD) {
					var Y = cal[0].fromJD(JD)[2];
					var DoY = JD - cal[0].toJD([31, 12, Y - 1]);
					var DoW = mod(JD, 7) + 1;
					var W = floor((10 + DoY - DoW) / 7);
					if (W < 1) {
						W = weekYearLength(Y - 1);
						Y--;
					} else if (W > weekYearLength(Y)) {
						W = 1;
						Y++;
					}
					return [DoW, W, Y];
				},
				function (IW) {
					var D = IW[0];
					var W = IW[1];
					var Y = IW[2];
					var base = cal[0].toJD([4, 1, Y]);
					return D + 7 * W - mod(base, 7) + base - 8;
				},
				function (IW, JD) {
					var D = IW[0];
					var W = IW[1];
					var Y = IW[2];
					return [week2[D] + ",", "week " + W + " of " + Y, "(" + Y + "-W" + W + "-" + D + ")"];
				},
				function (IW) {
					var result = false;
					var D = IW[0];
					var W = IW[1];
					var Y = IW[2];
					if (D >= 1 && D <= 7 && ((W >= 1 && W <= 52) || (W === 53 && weekYearLength(Y) === 53))) {
						result = true;
					}
					return result;
				},
				monthInput(12, week2, "day") + "&thinsp;/&thinsp;" + valueInput(12, 1, 53, "week") + "&thinsp;/&thinsp;" + yearInput(12)
			);
			cal[13] = new Cal(
				"Mayan",
				function (JD) {
					var epoch = 584283;
					var T = JD - epoch;
					var A = mod(T, 144000);
					var baktun = floor(T / 144000);
					var katun = floor(A / 7200);
					var B = A % 7200;
					var tun = floor(B / 360);
					var C = B % 360;
					var winal = floor(C / 20);
					var kin = C % 20;
					return [baktun, katun, tun, winal, kin];
				},
				function (M) {
					return 584283 + M[0] * 144000 + M[1] * 7200 + M[2] * 360 + M[3] * 20 + M[4];
				},
				function (M, JD) {
					var haabMonths = ["Pop", "Uo", "Zip", "Zotz", "Tzec", "Xul", "Yaxkin", "Mol", "Chen", "Yax", "Zac", "Ceh", "Mac", "Kankin", "Muan", "Pax", "Kayab", "Cumku", "Uayeb"];
					var tzolkinGods = ["Ahau", "Imix", "Ik", "Akbal", "Kan", "Chicchan", "Cimi", "Manik", "Lamat", "Muluc", "Oc", "Chuen", "Eb", "Ben", "Ix", "Men", "Cib", "Caban", "Etznab", "Caunac"];
					var H = mod(JD - 584300, 365);
					var haab = (H % 20) + " " + haabMonths[floor(H / 20)];
					var tzolkin = (mod(JD - 548293, 13) + 1) + " " + tzolkinGods[M[4]];
					var G = "G" + (mod(JD - 584284, 9) + 1);
					//return [M[0] + "." + M[1] + "." + M[2] + "." + M[3] + "." + M[4], tzolkin + " " + haab, G];
					return [M[0] + " baktun, " + M[1] + " katun,", M[2] + " tun, " + M[3] + " uinal,", M[4] + " kin, " + tzolkin + ",", haab + ", " + G, "(" + M[0] + "." + M[1] + "." + M[2] + "." + M[3] + "." + M[4] + ")"];
				},
				function (M) {
					var result = false;
					if (M[1] >= 0 && M[1] <= 19 && M[2] >= 0 && M[2] <= 19 && M[3] >= 0 && M[3] <= 17 && M[4] >= 0 && M[4] <= 19) {
						result = true;
					}
					return result;
				},
				number2Input(13, "baktun") + "." + valueInput(13, 0, 19, "katun") + "." + valueInput(13, 0, 19, "tun") + "." + valueInput(13, 0, 17, "uinal") + "." + valueInput(13, 0, 19, "kin")
			);
			cal[14] = new Cal(
				"Gregorian Lunar",
				function (JD) {
					var y = cal[0].fromJD(JD)[2];
					var NYs = [];
					for (var i = 0; i <= 3; i++) {
						NYs[i] = GLunarNewYear(y - 1 + i);
					}
					var j = 0;
					while (JD >= NYs[j]) {
						j++;
					}
					var ny = NYs[j - 1];
					var len = NYs[j] - ny;
					var year = y + j - 2;
					var T = JD - ny;
					var k = 1
					while (T - GLunarMonthLengths(k, len) >= 0) {
						T -= GLunarMonthLengths(k, len);
						k++;
					}
					return [T + 1, k, year];
				},
				function (GL) {
					var D = GL[0];
					var M = GL[1];
					var Y = GL[2];
					var T = GLunarNewYear(Y);
					var len = GLunarNewYear(Y + 1) - T;
					var i = 1;
					while (i < M) {
						T += GLunarMonthLengths(i, len);
						i++;
					}
					return T + D - 1;
				},
				function (GL, JD) {
					var P = "&nbsp;";
					var E = GregEpact(GL[2]);
					if (GL[0] === 14) {
						if (E === 24 || (E === 25 && mod(GL[2], 19) > 10)) {
							if (GL[1] === 5) {
								P = "(Paschal full moon)";
							}
						} else if (GL[1] === 4) {
							P = "(Paschal full moon)";
						}
					}
					return [week[mod(JD, 7)] + "day,", date(GL), P];
				},
				function (GL) {
					var D = GL[0];
					var M = GL[1];
					var Y = GL[2];
					var result = false;
					var len = GLunarNewYear(Y + 1) - GLunarNewYear(Y);
					if (D >= 1 && D <= 30 && M >= 1 && M <= 13) {
						result = true;
						if (D === 30 && ((M === 1 && len % 10 === 3) || (M % 2 === 0))) {
							result = false;
							if (M === 2 && len % 10 === 5) {
								result = true;
							}
						}
						if (M === 13 && len < 380) {
							result = false;
						}
					}
					return result;
				},
				dayInput(14, 30) + "&thinsp;/&thinsp;" + dayInput(14, 13, 1, "month") + "&thinsp;/&thinsp;" + yearInput(14)
			);
			cal[16] = new Cal(
				"Tabular Islamic (astro. epoch)",
				function (JD) {
					var diff = 1948439;
					var T = mod(JD - diff, 30 * 354 + 11);
					var j = 1;
					while (T >= IslamicYearLength(j, 2)) {
						T -= IslamicYearLength(j, 2);
						j++;
					}
					var Y = floor((JD - diff) / (30 * 354 + 11)) * 30 + j;
					var k = 1;
					while (T >= IslamicMonthLengths(k, j, 2)) {
						T -= IslamicMonthLengths(k, j, 2);
						k++;
					}
					return [T + 1, k, Y];
				},
				function (TI) {
					var D = TI[0];
					var M = TI[1];
					var Y = TI[2];
					var T = floor((Y - 1) / 30) * (30 * 354 + 11);
					for (var i = 1; i < mod(Y - 1, 30) + 1; i++) {
						T += IslamicYearLength(i, 2);
					}
					for (var j = 1; j < M; j++) {
						T += IslamicMonthLengths(j, mod(Y - 1, 30) + 1, 2);
					}
					return T + D + 1948439 - 1;
				},
				function (TI, JD) {
					return [week[mod(JD, 7)] + "day,", TI[0] + " " + IslamicMonths[TI[1]] + " " + TI[2] + " " + abbr("A.H.", "anno Hegirae"), "(" + date(TI) + ")"];
				},
				function (TI) {
					var result = false;
					var D = TI[0];
					var M = TI[1];
					var Y = TI[2];
					if (D >= 1 && D <= 30 && M >= 1 && M <= 12) {
						result = true;
						if (M % 2 === 0 && D === 30 && !(M === 12 && IslamicYearLength(mod(Y - 1, 30) + 1, 2) === 355)) {
							result = false;
						}
					}
					return result;
				},
				DMYInput(16, IslamicMonths, 30)
			);
			cal[17] = new Cal(
				"Tabular Islamic (civil epoch)",
				function (JD) {
					var diff = 1948440;
					var T = mod(JD - diff, 30 * 354 + 11);
					var j = 1;
					while (T >= IslamicYearLength(j, 2)) {
						T -= IslamicYearLength(j, 2);
						j++;
					}
					var Y = floor((JD - diff) / (30 * 354 + 11)) * 30 + j;
					var k = 1;
					while (T >= IslamicMonthLengths(k, j, 2)) {
						T -= IslamicMonthLengths(k, j, 2);
						k++;
					}
					return [T + 1, k, Y];
				},
				function (TI) {
					var D = TI[0];
					var M = TI[1];
					var Y = TI[2];
					var T = floor((Y - 1) / 30) * (30 * 354 + 11);
					for (var i = 1; i < mod(Y - 1, 30) + 1; i++) {
						T += IslamicYearLength(i, 2);
					}
					for (var j = 1; j < M; j++) {
						T += IslamicMonthLengths(j, mod(Y - 1, 30) + 1, 2);
					}
					return T + D + 1948440 - 1;
				},
				cal[16].display,
				cal[16].valid,
				DMYInput(17, IslamicMonths, 30)
			);
			cal[18] = new Cal(
				"Fatimid",
				function (JD) {
					var diff = 1948439;
					var T = mod(JD - diff, 30 * 354 + 11);
					var j = 1;
					while (T >= IslamicYearLength(j, 3)) {
						T -= IslamicYearLength(j, 3);
						j++;
					}
					var Y = floor((JD - diff) / (30 * 354 + 11)) * 30 + j;
					var k = 1;
					while (T >= IslamicMonthLengths(k, j, 3)) {
						T -= IslamicMonthLengths(k, j, 3);
						k++;
					}
					return [T + 1, k, Y];
				},
				function (TI) {
					var D = TI[0];
					var M = TI[1];
					var Y = TI[2];
					var T = floor((Y - 1) / 30) * (30 * 354 + 11);
					for (var i = 1; i < mod(Y - 1, 30) + 1; i++) {
						T += IslamicYearLength(i, 3);
					}
					for (var j = 1; j < M; j++) {
						T += IslamicMonthLengths(j, mod(Y - 1, 30) + 1, 3);
					}
					return T + D + 1948439 - 1;
				},
				cal[16].display,
				function (TI) {
					var result = false;
					var D = TI[0];
					var M = TI[1];
					var Y = TI[2];
					if (D >= 1 && D <= 30 && M >= 1 && M <= 12) {
						result = true;
						if (M % 2 === 0 && D === 30 && !(M === 12 && IslamicYearLength(mod(Y - 1, 30) + 1, 3) === 355)) {
							result = false;
						}
					}
					return result;
				},
				DMYInput(18, IslamicMonths, 30)
			);
			cal[19] = new Cal(
				"Julian Lunar",
				function (JD) {
					var base = JD;
					var Q = cal[1].fromJD(base);
					while (!(Q[0] === 24 && Q[1] === 12 & mod(Q[2], 19) === 18)) {
						base--;
						Q = cal[1].fromJD(base);
					}
					var T = JD - base;
					var mLList = JLunarMonthsList(Q[2]);
					var j = 0;
					while (T >= mLList[j].mL) {
						T -= mLList[j].mL;
						j++;
					}
					return [T + 1, mLList[j].m, mLList[j].y];
				},
				function (JL) {
					var D = JL[0];
					var M = JL[1];
					var Y = JL[2];
					var baseYear = floor(Y / 19) * 19 - 1;
					var T = cal[1].toJD([24, 12, baseYear]);
					var mLList = JLunarMonthsList(baseYear);
					var i = 0;
					while (!(M === mLList[i].m && Y === mLList[i].y) && i < 1000) {
						T += mLList[i].mL;
						i++;
					}
					return T + D - 1;
				},
				function (JL, JD) {
					var P = "&nbsp;";
					if (JL[0] === 14 && JL[1] === 4) {
						P = "(Paschal full moon)";
					}
					var mo = JLunarMonths[JL[1]];
					if (JL[1] === 13) {
						mo += "ic " + JLunarMonths[JulianEmbols[mod(JL[2], 19)]]; //JLunarMonths[mod(JulianEmbols[mod(JL[2], 19)], 12) + 1];
					}
					return [week[mod(JD, 7)] + "day,", JL[0] + " " + mo + " " + JL[2], P];
				},
				function (JL) {
					var D = JL[0];
					var M = JL[1];
					var Y = JL[2];
					var result = false;
					if (D >= 1 && D <= 30 && M >= 1 && M <= 13) {
						result = true;
						if ((M % 2 === 0 || (M === 7 && mod(Y, 19) === 18)) && D === 30) {
							result = false;
							if (M === 2 && mod(Y, 4) === 0) {
								result = true;
							}
						} else if (M === 13 && JulianEmbols[mod(Y, 19)] === 0) {
							result = false;
						}
					}
					return result;
				},
				DMYInput(19, JLunarMonths, 30)
			);
			cal[21] = new Cal(
				"Ethiopian",
				function (JD) {
					var C = cal[2].fromJD(JD);
					return [C[0], C[1], C[2] + 276];
				},
				function (Et) {
					return cal[2].toJD([Et[0], Et[1], Et[2] - 276]);
				},
				function (Et, JD) {
					return [week[mod(JD, 7)] + "day,", Et[0] + " " + EthiopianMonths[Et[1]] + " " + Et[2] + " " + abbr("A.D.", "anno Domini"), "(" + date(Et) + ")"];
				},
				function (Et) {
					return cal[2].valid([Et[0], Et[1], Et[2] - 276]);
				},
				DMYInput(21, EthiopianMonths, 30)
			);
			cal[22] = new Cal(
				"Hebrew",
				function (JD) {
					var guess = floor((JD - 347614) / meanDaysPerYear);
					var ny = HebrewNewYear(guess);
					var ny2 = HebrewNewYear(guess + 1);
					var j = 0;
					while ((JD < ny || JD >= ny2) && j < 1000) {
						if (JD < ny) {
							ny2 = ny;
							guess--;
							ny = HebrewNewYear(guess);
						} else {
							ny = ny2;
							guess++;
							ny2 = HebrewNewYear(guess + 1);
						}
						j++;
					}
					var y = guess;
					var len = ny2 - ny;
					var T = JD - ny;
					var i = 0;
					while (T >= HebrewMonthLength(i, len) && i < 100) {
						T -= HebrewMonthLength(i, len);
						i++;
					}
					var m = (i + 6) % 13 + 1;
					return [T + 1, m, y];
				},
				function (H) {
					var D = H[0];
					var M = (H[1] + 6) % 13;
					var Y = H[2];
					var T = HebrewNewYear(Y);
					var len = HebrewNewYear(Y + 1) - T;
					for (var i = 0; i < M; i++) {
						T += HebrewMonthLength(i, len);
					}
					return T + D - 1;
				},
				function (H, JD) {
					var M = HebrewMonths[H[1]];
					if (H[1] === 13) {
						if (isHebrewLeap(H[2])) {
							M = "Adar II";
						} else {
							M = "Adar";
						}
					}
					return [week[mod(JD, 7)] + "day,", H[0] + " " + M + " " + H[2] + " " + abbr("A.M.", "anno mundi")];
				},
				function (H) {
					var D = H[0];
					var M = (H[1] + 6) % 13;
					var Y = H[2];
					var result = false;
					var len = HebrewNewYear(Y + 1) - HebrewNewYear(Y); 
					if (M >= 0 && M < 13) {
						if (D >= 1 && D <= HebrewMonthLength(M, len)) {
							result = true;
						}
					}
					return result;
				},
				DMYInput(22, HebrewMonths, 30)
			);
			cal[23] = new Cal(
				"Byzantine",
				function (JD) {
					var J = cal[1].fromJD(JD);
					var M = (J[1] + 3) % 12 + 1;
					var Y = J[2] + 5508;
					if (J[1] >= 9) {
						Y++;
					}
					return [J[0], M, Y];
				},
				function (B) {
					var D = B[0];
					var M = (B[1] + 7) % 12 + 1;
					var Y = B[2] - 5508;
					if (M >= 9) {
						Y--;
					}
					return cal[1].toJD([D, M, Y]);
				},
				function (B, JD) {
					return [week[mod(JD, 7)] + "day,", B[0] + " " + ByzantineMonths[B[1]] + " " + B[2] + " " + abbr("A.M.", "anno mundi"), "(" + date(B) + ")"];
				},
				function (B) {
					var D = B[0];
					var M = (B[1] + 7) % 12 + 1;
					var Y = B[2] - 5508;
					if (M >= 9) {
						Y--;
					}
					return cal[1].valid([D, M, Y]);
				},
				DMYInput(23, ByzantineMonths, 31)
			);
			cal[24] = new Cal(
				"Rata Die",
				function (JD) {
					return [JD - 1721425];
				},
				function (R) {
					return R[0] + 1721425;
				},
				function (R, JD) {
					return [abbr("R.D.", "rata die") + " " + R[0]];
				},
				function (R) {
					return true;
				},
				numberInput(24, "Rata die")
			);
			cal[25] = new Cal(
				"French Republican (real/Romme version)",
				function (JD) {
					var result = cal[3].fromJD(JD);
					if (result[2] > 0 && result[2] < 18) {
						result = cal[4].fromJD(JD);
					}
					return result;
				},
				function (F) {
					var result = cal[3].toJD(F);
					if (F[2] > 0 && F[2] < 18) {
						result = cal[4].toJD(F);
					}
					return result;
				},
				cal[3].display,
				function (F) {
					var result = cal[3].valid(F);
					if (F[2] > 0 && F[2] < 18) {
						result = cal[4].valid(F);
					}
					return result;
				},
				DMYInput(25, frenchMonths, 30),
				false
			);
			cal[26] = new Cal(
				"Ordinal Date",
				function (JD) {
					var Y = cal[0].fromJD(JD)[2];
					var D = JD - cal[0].toJD([1, 1, Y]) + 1;
					return [D, Y];
				},
				function (O) {
					var D = O[0];
					var Y = O[1];
					var JD = cal[0].toJD([1, 1, Y]) + D - 1;
					return JD;
				},
				function (O, JD) {
					var D = O[0];
					var Y = O[1];
					var d = D.toString();
					if (D < 100) {
						d = "0" + d;
					}
					if (D < 10) {
						d = "0" + d;
					}
					return ["The " + Ordinal(D) + " day of " + Y, "(" + Y + "-" + d + ")"];
				},
				function (O) {
					var D = O[0];
					var Y = O[1];
					return (D >= 1 && D <= 365) || (D === 366 && (mod(Y, 400) === 0 || (mod(Y, 4) === 0 && mod(Y, 100) != 0)));
				},
				valueInput(26, 1, 366, "day") + "&thinsp;/&thinsp;" + yearInput(26)
			);
			cal[15] = new Cal(
				"Armenian",
				function (JD) {
					var T = JD - ArmenianJDepoch;
					var Y = floor(T / 365) + 1;
					var M = floor(mod(T, 365) / 30) + 1;
					var D = T - 365 * (Y - 1) - 30 * (M - 1) + 1;
					return [D, M, Y];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					return ArmenianJDepoch + 365 * (Y - 1) + 30 * (M - 1) + D - 1;
				},
				function (A, JD) {
					return [week[mod(JD, 7)] + "day,", longDate(A, ArmenianMonths), "(" + date(A) + ")"];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					return D >= 1 && M >= 1 && ((M <= 12 && D <= 30) || (M === 13 && D <= 5)); 
				},
				DMYInput(15, ArmenianMonths, 30)
			);
			cal[20] = new Cal(
				"Nanakshahi",
				function (JD) {
					var G = cal[0].fromJD(JD);
					var GY = G[2];
					var Y = GY - SikhYearZero;
					var NY = cal[0].toJD([14, 3, GY]);
					if (JD < NY) {
						Y--;
						NY = cal[0].toJD([14, 3, GY - 1]);
					}
					var D = JD - NY + 1;
					var M = 1;
					while (D - SikhMonthLengths(M) > 0) {
						D -= SikhMonthLengths(M);
						M++;
					}
					return [D, M, Y];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var GY = SikhYearZero + Y;
					var NY = cal[0].toJD([14, 3, GY]);
					var JD = NY + D - 1;
					var i = 1;
					while (i < M) {
						JD += SikhMonthLengths(i);
						i++;
					}
					return JD;
				},
				function (A, JD) {
					return [week[mod(JD, 7)] + "day,", longDate(A, SikhMonths), "(" + date(A) + ")"];
				},
				function (A, JD) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var GYatEnd = SikhYearZero + Y + 1;
					return D >= 1 && M >= 1 && M <= 12 && D <= SikhMonthLengths(M) && (D != 31 || M != 12 || isGregorianLeap(GYatEnd));
				},
				DMYInput(20, SikhMonths, 31)
			);
			cal[27] = new Cal(
				"Gregorian Roman-form",
				function (JD) {
					var A = cal[0].fromJD(JD);
					var Y = A[2];
					var isLeap = isGregorianLeap(Y);
					return toRomanForm(A, isLeap);
				},
				function (A) {
					var Y = A[4];
					var isLeap = isGregorianLeap(Y);
					return cal[0].toJD(fromRomanForm(A, isLeap));
				},
				function (A, JD) {
					var bis = A[0];
					var RC = A[1];
					var RP = A[2];
					var RM = A[3];
					var RY = A[4];
					var line1 = "The ";
					var line2 = "(";
					if (RC != 1) {
						if (RC != 2) {
							line2 += abbr("a.d.", "ante diem", false) + " ";
							if (bis === 2) {
								line1 += "doubled ";
								line2 += "bis "
							}
							line1 += Ordinal(RC) + " ";
							line2 += Roman(RC) + " ";
						} else {
							line2 += abbr("prid.", "pridie", false) + " ";
						}
						line1 += "day before the ";
					}
					line1 += RomanEvents[RP] + "&nbsp;of&nbsp;" + months[RM] + "&nbsp;" + RY;
					line2 += abbr(RomanEventsAbbr[RP] + ".", RomanEvents[RP], false) + " " + abbr(monthsAbbr[RM] + ".", months[RM], false) + " " + RY + ")";
					return [line1, line2];
				},
				function (A) {
					var Y = A[4];
					var isLeap = isGregorianLeap(Y);
					return isValidRomanForm(A, isLeap);
				},
				monthInput(27, [0, " ", "bis"], "leap") + " " + dayInput(27, 19, 1, "count") + " " + monthInput(27, RomanEvents, "event") + " " + monthInput(27, months) + " " + yearInput(27)
			);
			cal[28] = new Cal(
				"Julian Roman-form",
				function (JD) {
					var A = cal[1].fromJD(JD);
					var Y = A[2];
					var isLeap = mod(Y, 4) === 0;
					return toRomanForm(A, isLeap);
				},
				function (A) {
					var Y = A[4];
					var isLeap = mod(Y, 4) === 0;
					return cal[1].toJD(fromRomanForm(A, isLeap));
				},
				cal[27].display,
				function (A) {
					var Y = A[4];
					var isLeap = mod(Y, 4) === 0;
					return isValidRomanForm(A, isLeap);
				},
				monthInput(28, [0, " ", "bis"], "leap") + " " + dayInput(28, 19, 1, "count") + " " + monthInput(28, RomanEvents, "event") + " " + monthInput(28, months) + " " + yearInput(28)
			);
			cal[29] = new Cal(
				"Icelandic week",
				function (JD) {
					var G = cal[0].fromJD(JD);
					var D = mod(JD + 1, 7) + 1; // Sunday = 1, Saturday = 7
					var W;
					var S;
					var Y = G[2];
					var lastNY = cal[0].toJD(IcelandicNewYear(Y));
					var nextNY = cal[0].toJD(IcelandicNewYear(Y + 1));
					if (JD < lastNY) {
						Y--;
						nextNY = lastNY;
						lastNY = cal[0].toJD(IcelandicNewYear(Y));
					}
					var winter = nextNY - 180;
					var seasonStart = lastNY;
					if (JD < winter) {
						S = 1;
					} else {
						S = 2;
						seasonStart = winter;
					}
					W = floor((JD - seasonStart) / 7) + 1;
					return [D, W, S, Y];
				},
				function (A) {
					var D = A[0];
					var W = A[1];
					var S = A[2];
					var Y = A[3];
					var NY = cal[0].toJD(IcelandicNewYear(Y));
					var winter = cal[0].toJD(IcelandicNewYear(Y + 1)) - 180;
					var JD;
					var d = mod(D + 2, 7) + 1;
					if (S === 1) {
						JD = NY + mod(D + 2, 7);
					} else {
						JD = winter + mod(D, 7);
					}
					JD += (W - 1) * 7;
					return JD;
				},
				function (A, JD) {
					var D = A[0];
					var W = A[1];
					var S = A[2];
					var Y = A[3];
					return [weekSun[D] + ",", "week " + W + " of " + IcelandicSeasons[S] + " " + Y];
				},
				function (A) {
					var D = A[0];
					var W = A[1];
					var S = A[2];
					var Y = A[3];
					var yearLength = cal[0].toJD(IcelandicNewYear(Y + 1)) - cal[0].toJD(IcelandicNewYear(Y));
					var result = false;
					if (D >= 1 && D <= 7 && W >= 1) {
						if (S === 1) {
							var lastWeek = 27;
							if (yearLength > 364) {
								lastWeek = 28;
							}
							if (W < lastWeek) {
								result = true;
							} else if (W === lastWeek && (D === 5 || D === 6)) {
								result = true;
							}
						} else if (S === 2 && (W <= 25 || (W === 26 && D != 5 && D != 6))) {
							result = true;
						}
					}
					return result;
				},
				monthInput(29, weekSun, "day") + " " + valueInput(29, 1, 28, "week") + " " + monthInput(29, IcelandicSeasons, "season") + " " + yearInput(29)
			);
			cal[30] = new Cal(
				"Icelandic month", // 30-day months numbered 1-12; extra days and leap week between 3rd and 4th month numbered 13 and 14 respectively.
				function (JD) {
					var G = cal[0].fromJD(JD);
					var Y = G[2];
					var lastMidsum = cal[0].toJD(IcelandicNewYear(Y + 1)) - 270;
					if (JD < lastMidsum) {
						Y--;
						lastMidsum = cal[0].toJD(IcelandicNewYear(Y + 1)) - 270;
					}
					var T = JD - lastMidsum;
					var M = floor(T / 30) + 1;
					var D = mod(T, 30) + 1;
					if (M === 13 && D > 4) {
						M = 14;
						D -= 4;
					}
					if (M <= 9) {
						M += 3;
					} else {
						Y++;
						if (M <= 12) {
							M -= 9;
						}
					}
					return [D, M, Y];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					if (M >= 4 && M <= 12) {
						M -= 3;
					} else {
						Y--;
						if (M <= 3) {
							M += 9;
						} else if (M === 14) {
							M--;
							D += 4;
						}
					}
					var lastMidsum = cal[0].toJD(IcelandicNewYear(Y + 1)) - 270;
					return lastMidsum + (M - 1) * 30 + D - 1;
				},
				function (A, JD) {
					var M = A[1];
					var Mno;
					if (M <= 6) {
						Mno = "S" + M;
					} else if (M <= 12) {
						Mno = "W" + (M - 6);
					} else if (M === 13) {
						Mno = "Sa";
					} else {
						Mno = "Ss";
					}
					return [week[mod(JD, 7)] + "day,", longDate(A, IcelandicMonths), "(" + date([A[0], Mno, A[2]]) + ")"];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var yearLength = cal[0].toJD(IcelandicNewYear(Y + 1)) - cal[0].toJD(IcelandicNewYear(Y));
					return D >= 1 && M >= 1 && ((M <= 12 && D <= 30) || (M === 13 && D <= 4) || (yearLength > 364 && M === 14 && D <= 7));
				},
				DMYInput(30, IcelandicMonths, 30)
			);
			cal[31] = new Cal(
				"Bangladeshi (2019 version)",
				function (JD) {
					var G = cal[0].fromJD(JD);
					var GY = G[2];
					var NY = cal[0].toJD([14, 4, GY]);
					if (JD < NY) {
						GY--;
						NY = cal[0].toJD([14, 4, GY]);
					}
					var Y = GY - BengaliYearZero;
					var isLeap = isGregorianLeap(GY + 1);
					var D = JD - NY + 1;
					var M = 1;
					while (D - BangladeshiMonthLengths(M, isLeap, true) > 0) {
						D -= BangladeshiMonthLengths(M, isLeap, true);
						M++;
					}
					return [D, M, Y];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var GY = BengaliYearZero + Y;
					var NY = cal[0].toJD([14, 4, GY]);
					var isLeap = isGregorianLeap(GY + 1);
					var JD = NY + D - 1;
					var i = 1;
					while (i < M) {
						JD += BangladeshiMonthLengths(i, isLeap, true);
						i++;
					}
					return JD;
				},
				function (A, JD) {
					return [week[mod(JD, 7)] + "day,", longDate(A, BengaliMonths) + " " + abbr("B.S.", "Bengali Sambat"), "(" + date(A) + ")"];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var GY = BengaliYearZero + Y;
					var isLeap = isGregorianLeap(GY + 1);
					return D >= 1 && M >= 1 && M <= 12 && D <= BangladeshiMonthLengths(M, isLeap, true);
				},
				DMYInput(31, BengaliMonths, 31)
			);
			cal[32] = new Cal(
				"Bangladeshi (pre-2019 version)",
				function (JD) {
					var G = cal[0].fromJD(JD);
					var GY = G[2];
					var NY = cal[0].toJD([14, 4, GY]);
					if (JD < NY) {
						GY--;
						NY = cal[0].toJD([14, 4, GY]);
					}
					var Y = GY - BengaliYearZero;
					var isLeap = isGregorianLeap(GY + 1);
					var D = JD - NY + 1;
					var M = 1;
					while (D - BangladeshiMonthLengths(M, isLeap, false) > 0) {
						D -= BangladeshiMonthLengths(M, isLeap, false);
						M++;
					}
					return [D, M, Y];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var GY = BengaliYearZero + Y;
					var NY = cal[0].toJD([14, 4, GY]);
					var isLeap = isGregorianLeap(GY + 1);
					var JD = NY + D - 1;
					var i = 1;
					while (i < M) {
						JD += BangladeshiMonthLengths(i, isLeap, false);
						i++;
					}
					return JD;
				},
				function (A, JD) {
					return [week[mod(JD, 7)] + "day,", longDate(A, BengaliMonths) + " " + abbr("B.S.", "Bengali Sambat"), "(" + date(A) + ")"];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var GY = BengaliYearZero + Y;
					var isLeap = isGregorianLeap(GY + 1);
					return D >= 1 && M >= 1 && M <= 12 && D <= BangladeshiMonthLengths(M, isLeap, false);
				},
				DMYInput(32, BengaliMonths, 31),
				false
			);
			cal[33] = new Cal(
				"Bah&#225;&#8217;&#237; (Greg.-fixed version)",
				function (JD) {
					var G = cal[0].fromJD(JD);
					var GY = G[2];
					var ala = cal[0].toJD([2, 3, GY]);
					if (JD < ala) {
						GY--;
						ala = cal[0].toJD([2, 3, GY]);
					}
					var Y = GY - BahaiYearZero;
					var isLeap = isGregorianLeap(GY + 1);
					var T = JD - ala;
					var M = floor(T / 19);
					var D = mod(T, 19) + 1;
					if (M === 0) {
						M = 20;
						Y--;
					}
					return [D, M, Y];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					if (M === 20) {
						M = 0;
						Y++;
					}
					var GY = BahaiYearZero + Y;
					var ala = cal[0].toJD([2, 3, GY]);
					return ala + M * 19 + D - 1;
				},
				function (A, JD) {
					var M = A[1];
					if (M === 19) {
						M = "A";
					} else if (M === 20) {
						M = 19;
					}
					return [week[mod(JD, 7)] + "day,", longDate(A, BahaiMonths) + " " + abbr("B.E.", "Bah&#225;&#8217;&#237; Era"), "(" + date([A[0], M, A[2]]) + ")"];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var GY = BahaiYearZero + Y;
					var isLeap = isGregorianLeap(GY + 1);
					return D >= 1 && M >= 1 && (((M <= 18 || M === 20) && D <= 19) || (M === 19 && (D <= 4 || (isLeap && D === 5))));
				},
				DMYInput(33, BahaiMonths, 19)
			);
			cal[34] = new Cal(
				"Javanese (4th kurup version)",
				function (JD) {
					var daysSinceEpoch = JD - JavaneseKurupStartJD; // all 0-indexed
					var kurupsSinceEpoch = floor(daysSinceEpoch / JavaneseKurupLength);
					var dayInKurup = mod(daysSinceEpoch, JavaneseKurupLength);
					var windu = floor(dayInKurup / JavaneseWinduLength);
					var dayInWindu = mod(dayInKurup, JavaneseWinduLength);
					var D = dayInWindu + 1; // all 1-indexed
					var yearInWindu = 1;
					while (D > JavaneseYearLengths(yearInWindu)) {
						D -= JavaneseYearLengths(yearInWindu);
						yearInWindu++;
					}
					var M = 1;
					while (D > JavaneseMonthLengths(M)) {
						D -= JavaneseMonthLengths(M);
						M++;
					}
					Y = JavaneseKurupStartYear + kurupsSinceEpoch * 120 + windu * 8 + yearInWindu - 1;
					return [D, M, Y];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var kurup = floor((Y - JavaneseKurupStartYear) / 120);
					var yearInKurup = mod(Y - JavaneseKurupStartYear, 120);
					var winduInKurup = floor(yearInKurup / 8);
					var yearInWindu = mod(yearInKurup, 8);
					var JD = JavaneseKurupStartJD + (D - 1) + kurup * JavaneseKurupLength + winduInKurup * JavaneseWinduLength;
					for (var i = 0; i < yearInWindu; i++) {
						JD += JavaneseYearLengths(i + 1);
					}
					for (var i = 1; i < M; i++) {
						JD += JavaneseMonthLengths(i);
					}
					return JD;
				},
				function (A, JD) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var fiveDays = mod(JD + 2, 5); // Pon = 0;
					var sevenDays = mod(JD + 1, 7); // Sunday = 0
					var yearInWindu = mod(Y - JavaneseKurupStartYear, 8) + 1;
					return [JavaneseSevenDays[sevenDays] + " " + JavaneseFiveDays[fiveDays] + ",", D + " " + JavaneseMonths[M] + " " + JavaneseYears[yearInWindu] + " " + Y + " " + abbr("A.J.", "anno Javanico"), "(" + date(A) + ")"];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var yearInKurup = mod(Y - JavaneseKurupStartYear, 120);
					var yearInWindu = mod(yearInKurup, 8) + 1;
					return D >= 1 && M >= 1 && M <= 12 && D <= JavaneseMonthLengths(M) && !(D === 30 && M === 12 && (JavaneseYearLengths(yearInWindu) === 354 || yearInKurup === 119));
				},
				DMYInput(34, JavaneseMonths, 30)
			);
			cal[35] = new Cal(
				"Persian (33-year version)",
				function (JD) {
					var daysSinceRef = JD - PersianRefJD;
					var cyclesSinceRef = floor(daysSinceRef / PersianDaysPerCycle);
					var D = mod(daysSinceRef, PersianDaysPerCycle) + 1;
					var yearInCycle = 0;
					while (D > PersianYearLengths(yearInCycle)) {
						D -= PersianYearLengths(yearInCycle);
						yearInCycle++;
					}
					var M = 1;
					while (D > PersianMonthLengths(M)) {
						D -= PersianMonthLengths(M);
						M++;
					}
					var Y = PersianRefYear + cyclesSinceRef * 33 + yearInCycle;
					return [D, M, Y];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					var yearsSinceRef = Y - PersianRefYear;
					var cyclesSinceRef = floor(yearsSinceRef / 33);
					var yearInCycle = mod(yearsSinceRef, 33);
					var JD = PersianRefJD + cyclesSinceRef * PersianDaysPerCycle + D - 1;
					for (var i = 0; i < yearInCycle; i++) {
						JD += PersianYearLengths(i);
					}
					for (var i = 1; i < M; i++) {
						JD += PersianMonthLengths(i);
					}
					return JD;
				},
				function (A, JD) {
					return [week[mod(JD, 7)] + "day,", longDate(A, PersianMonths) + " " + abbr("A.P.", "anno Persico"), "(" + date(A) + ")"];
				},
				function (A) {
					var D = A[0];
					var M = A[1];
					var Y = A[2];
					return M >= 1 && M <= 12 && D >= 1 && D <= PersianMonthLengths(M) && !(D === 30 && M === 12 && PersianYearLengths(mod(Y, 33)) === 365);
				},
				DMYInput(35, PersianMonths, 31)
			);
			//Today
			var run = function () {
				var now = new Date();
				var JD = cal[0].toJD([now.getDate(), now.getMonth() + 1, now.getFullYear()]);
				var newCal = Number(document.getElementById("todaySelect").value);
				var result = cal[newCal].fromJD(JD);
				var display = cal[newCal].display(result, JD);
				document.getElementById("todayResult").innerHTML = show(display);
			}
			//Things
			var nameCalendar = function(name) {
				var b = name.indexOf("(");
				var result = name + " calendar";
				if (b >= 0) {
					result = name.substring(0, b) + "calendar " + name.substring(b);
				}
				return result;
			}
			var getFirstCal = function () {
				return Number(document.getElementById("fromSelect").value);
			}
			var getSecondCal = function () {
				return Number(document.getElementById("toSelect").value);
			}
			//Convert
			var convert = function () {
				var firstCal = getFirstCal();
				var secondCal = getSecondCal();
				var dateIn = [];
				var integerInput = true;
				for (var i = 0; i < document.getElementsByClassName("dateIn" + firstCal).length; i++) {
					dateIn[i] = Number(document.getElementsByClassName("dateIn" + firstCal)[i].value);
					if (dateIn[i] % 1 != 0 || document.getElementsByClassName("dateIn" + firstCal)[i].value === "") {
						integerInput = false;
					}
				}
				var firstCalDisplayBox = "";
				var secondCalDisplayBox = "";
				if (integerInput && cal[firstCal].valid(dateIn)) {
					var JD = cal[firstCal].toJD(dateIn);
					var dateOut = cal[secondCal].fromJD(JD);
					var firstCalDisplay = cal[firstCal].display(dateIn, JD);
					var secondCalDisplay = cal[secondCal].display(dateOut, JD);
					firstCalDisplayBox = "<b>" + nameCalendar(cal[firstCal].name) + "</b><br>" + show(firstCalDisplay);
					secondCalDisplayBox = "<b>" + nameCalendar(cal[secondCal].name) + "</b><br>" + show(secondCalDisplay);
				} else if (integerInput) {
					firstCalDisplayBox = "ERROR<br>Invalid date";
					secondCalDisplayBox = "Try again.";
				} else {
					firstCalDisplayBox = "ERROR<br>Invalid input";
					secondCalDisplayBox = "Try again.";
				}
				document.getElementById("firstCalDisplay").innerHTML = firstCalDisplayBox;
				document.getElementById("secondCalDisplay").innerHTML = secondCalDisplayBox;
			}
			//Setup
			var order = [0, 1, 22, 2, 11, 12, 26, 5, 35, 21, 16, 17, 18, 20, 31, 32, 34, 6, 7, 24, 10, 8, 9, 13, 3, 4, 25, 33, 14, 19, 23, 15, 27, 28, 29, 30];
			var setup = function () {
				var todaySelect = "";
				var fromSelect = "";
				var inputBox = "";
				//var list = ""; 
				for (var i = 0; i < order.length; i++) {
					var j = order[i];
					var option = '<option value="' + j + '">' + cal[j].name + '</option>';
					if (cal[j].today) {
						todaySelect += option;
					}
					fromSelect += option;
					inputBox += '<p id="inputPanel' + j + '" class="inputPanel"';
					if (j != 0) {
						inputBox += ' style="display: none"';
					}
					inputBox += '>' + cal[j].input + '</p>';
					cal[j].input = "";
					//list += j + ". " + cal[j].name + "<br>";
				}
				document.getElementById("todaySelect").innerHTML = todaySelect;
				document.getElementById("fromSelect").innerHTML = fromSelect;
				document.getElementById("toSelect").innerHTML = fromSelect;
				document.getElementById("inputBox").innerHTML = inputBox;
				//document.getElementById("list").innerHTML = list;
				run();
			}
			//Change input
			var change = function () {
				var newCal = getFirstCal();
				for (var i = 0; i < order.length; i++) {
					var j = order[i];
					var dis = "none";
					if (j === newCal) {
						dis = "block";
					}
					document.getElementById("inputPanel" + j).style.display = dis;
				}
				for (var i = 0; i < document.getElementsByClassName("dateIn" + newCal).length; i++) {
					document.getElementsByClassName("dateIn" + newCal)[i].value = "";
				}
			}
			//Miscellaneous
			var applyDate = function (x, a) {
				for (var i = 0; i < a.length; i++) {
					document.getElementsByClassName("dateIn" + x)[i].value = a[i].toString();
				}
			}
			var increment = function (n) {
				var firstCal = getFirstCal();
				var dateIn = [];
				var integerInput = true;
				for (var i = 0; i < document.getElementsByClassName("dateIn" + firstCal).length; i++) {
					dateIn[i] = Number(document.getElementsByClassName("dateIn" + firstCal)[i].value);
					if (dateIn[i] % 1 != 0 || document.getElementsByClassName("dateIn" + firstCal)[i].value === "") {
						integerInput = false;
					}
				}
				if (integerInput && cal[firstCal].valid(dateIn)) {
					var JD = cal[firstCal].toJD(dateIn);
					var dateOut = cal[firstCal].fromJD(JD + n);
					applyDate(firstCal, dateOut);
					convert();
				}
			}
			var swap = function () {
				var firstCal = getFirstCal();
				var secondCal = getSecondCal();
				var dateIn = [];
				var integerInput = true;
				for (var i = 0; i < document.getElementsByClassName("dateIn" + firstCal).length; i++) {
					dateIn[i] = Number(document.getElementsByClassName("dateIn" + firstCal)[i].value);
					if (dateIn[i] % 1 != 0 || document.getElementsByClassName("dateIn" + firstCal)[i].value === "") {
						integerInput = false;
					}
				}
				if (integerInput && cal[firstCal].valid(dateIn)) {
					var JD = cal[firstCal].toJD(dateIn);
					var dateOut = cal[secondCal].fromJD(JD);
					document.getElementById("fromSelect").value = secondCal.toString();
					document.getElementById("toSelect").value = firstCal.toString();
					change();
					applyDate(secondCal, dateOut);
					convert();
				} else if (!integerInput) {
					document.getElementById("fromSelect").value = secondCal.toString();
					document.getElementById("toSelect").value = firstCal.toString();
					change();
				}
			}
			var applyToday = function () {
				var now = new Date();
				var JD = cal[0].toJD([now.getDate(), now.getMonth() + 1, now.getFullYear()]);
				var theCal = Number(document.getElementById("fromSelect").value);
				var result = cal[theCal].fromJD(JD);
				applyDate(theCal, result);
				convert();
			}
			var key = function (event) {
				var k = event.key.toLowerCase();
				if (k === "enter") {
					convert();
				} else if (k === "w") {
					increment(1);
				} else if (k === "s") {
					increment(-1);
				} else if (k === "x") {
					swap();
				} else if (k === "t") {
					applyToday();
				}
			}
		</script>
		<h1>Calendrical Conversions</h1>
		<p id="subtitle">A most commendable consultant to the correspondence of a collection of common calculable calendars.</p>
		<hr>
		<div id="header">
			<p><b>Today</b> is</p>
			<p>
				<span id="todayResult" class="resultBox"></span>
			</p>
			<p>in the
				<select id="todaySelect" class="calSelect" onChange="run()"></select>
			calendar.</p>
		</div>
		<hr>
		<div id="body">
			<p><b>Convert</b></p>
			<div class="wrapper">
				<div>
					<p>
						<select id="fromSelect" class="calSelect" onChange="change()"></select>
					</p>
				</div>
				<div>
					<p>to</p>
				</div>
				<div>
					<p>
						<select id="toSelect" class="calSelect"></select>
					</p>
				</div>
				<div id="inputBox"></div>
				<div>&nbsp;</div>
				<div>
					<p>
						<span class="btn" onClick="convert()" tabindex=0>Convert</span>
					</p>
				</div>
				<div class="justify">
					<p>
						<span id="firstCalDisplay" class="resultBox"><span class="small">Choose the calendars to convert between and enter a date above.</span></span>
					</p>
				</div>
				<div class="justify">
					<p style="font-size: 36px">=</p>
				</div>
				<div class="justify">
					<p>
						<span id="secondCalDisplay" class="resultBox"><span class="small">Click 'Convert' and the result will appear here.</span></span>
					</p>
				</div>
			</div>
		</div>
		<hr>
		<div id="footer">
			<p>N.B. This converter serves only <i>arithmetic</i> calendars (ie. calendars determined by fixed rules) as opposed to <i>observational</i> calendars (ie. calendars determined by astronomical observation).<br>Apologies if your favourite calendar is observational. More sincere apologies if your favourite calendar is arithemtic but not (yet) served here.<br>&#169; Joshua, 2021.</p>
		</div>
		<div id="home">
			<a href="index.html">
				<img src="images/logo.png" id="homeLogo">
			</a>
		</div>
	</body>
</html>